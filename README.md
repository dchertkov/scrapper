# The Best Scraper

Сервис мониторинг доступности определенного набора сервисов.

## Сборка и запуск

Команда для сборки:

```bash
make build
```

Старт сервиса мониторинга:

```bash
./scrapper
```

## Конфигурация

Конфигурация осуществляется через переменные окружения.

* `SCRAPPER_SERVER_HOST` - хост сервера, значение по умолчанию `127.0.0.1`
* `SCRAPPER_SERVER_PORT` - порт сервера, значение по умолчанию `3000`
* `SCRAPPER_SOURCE_FILE` - путь до файла с списоком сервисов для опроса доступности, значение по умолчанию `sites.txt`
* `SCRAPPER_CHECKER_WORKERS` - кол-во параллельных воркеров для опроса сервисов, значение по умолчанию `20`
* `SCRAPPER_CHECKER_TIMEOUT` - таймаут запроса при опросе сервиса на доступность, значение по умолчанию `5s`
* `SCRAPPER_CHECKER_INTERVAL` - интервал запуска проверок доступности сервисов, значение по умолчанию `1m`

## API

### Получить время доступа к сервису
```
GET /service/{host}
```
Метод возвращает время доступа к сервису `host`.

Ответ:
```json
{
  "host": "google.com",          // имя хоста
  "available": true,             // флаг доступности
  "availability_time": 375560059 // время доступа к хосту в наносекундах
}
```

### Получить статистику запросов от пользователей
```
GET /service/{host}/stat
```
Метод возвращает статистику запросов от пользователей, которые просматривали время доступа к сервису `host`.

Ответ:
```json
{
  "request_total": 7,     // общее кол-во запросов
  "request_per_minute": 6 // кол-во запросов в минуту
}
```

### Получить сервис с минимальным временем доступа
```
GET /service/time/min
```
Метод возвращает сервис с минимальным временем доступа.

Ответ:
```json
{
  "host": "google.com",          // имя хоста
  "available": true,             // флаг доступности
  "availability_time": 375560059 // время доступа к хосту в наносекундах
}
```

### Получить сервис с максимальным временем доступа
```
GET /service/time/max
```
Метод возвращает сервис с максимальным временем доступа. Данный метод возвращает только доступные сервисы.

Ответ:
```json
{
  "host": "google.com",          // имя хоста
  "available": true,             // флаг доступности
  "availability_time": 375560059 // время доступа к хосту в наносекундах
}
```
